<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time-Dependent Solvers · GradientRobustMultiPhysics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GradientRobustMultiPhysics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Problem Description</span><ul><li><a class="tocitem" href="../pdedescription/">PDE Description</a></li><li><a class="tocitem" href="../pdeoperators/">PDE Operators</a></li><li><a class="tocitem" href="../functionoperators/">Function Operators</a></li><li><a class="tocitem" href="../userdata/">User Data and Actions</a></li><li><a class="tocitem" href="../boundarydata/">Boundary Data</a></li><li><a class="tocitem" href="../globalconstraints/">Global Constraints</a></li><li><a class="tocitem" href="../pdeprototypes/">PDE Prototypes</a></li></ul></li><li><span class="tocitem">Discretisation</span><ul><li><a class="tocitem" href="../meshing/">Meshing</a></li><li><a class="tocitem" href="../fems/">Implemented Finite Elements</a></li><li><a class="tocitem" href="../fespace/">Finite Element Spaces and Arrays</a></li><li><a class="tocitem" href="../interpolations/">Finite Element Interpolations</a></li></ul></li><li><span class="tocitem">Solving</span><ul><li><a class="tocitem" href="../pdesolvers/">Fixed-Time Solvers</a></li><li class="is-active"><a class="tocitem" href>Time-Dependent Solvers</a><ul class="internal"><li><a class="tocitem" href="#TimeControlSolver"><span>TimeControlSolver</span></a></li><li><a class="tocitem" href="#Advancing-a-TimeControlSolver"><span>Advancing a TimeControlSolver</span></a></li></ul></li></ul></li><li><span class="tocitem">Postprocessing</span><ul><li><a class="tocitem" href="../itemintegrators/">Item Integrators</a></li><li><a class="tocitem" href="../pointevaluators/">Point Evaluators</a></li><li><a class="tocitem" href="../viewers/">Viewers</a></li><li><a class="tocitem" href="../export/">Data Export</a></li></ul></li><li><span class="tocitem">Low-Level Structures</span><ul><li><a class="tocitem" href="../quadrature/">Quadrature</a></li><li><a class="tocitem" href="../assemblypatterns/">Assembly Patterns</a></li><li><a class="tocitem" href="../febasisevaluators/">FE Basis Evaluators</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples_intro/">About the examples</a></li><li><a class="tocitem" href="../examples/Example101_Bestapproximation1D/">101 : L2-Bestapproximation 1D</a></li><li><a class="tocitem" href="../examples/Example201_PoissonProblem2D/">201 : Poisson-Problem 2D</a></li><li><a class="tocitem" href="../examples/Example202_LinearElasticity2D/">202 : Linear Elasticity</a></li><li><a class="tocitem" href="../examples/Example203_ReactionConvectionDiffusion2D/">203 : Reaction-Convection-Diffusion-Problem 2D</a></li><li><a class="tocitem" href="../examples/Example204_PoissonLshapeAdaptive2D/">204 : Poisson L-shape Adaptive Mesh Refinement</a></li><li><a class="tocitem" href="../examples/Example205_PlanarLatticeFlow2D/">205 : Planar Lattice Flow 2D</a></li><li><a class="tocitem" href="../examples/Example206_PressureRobustness2D/">206 : Pressure-robustness 2D</a></li><li><a class="tocitem" href="../examples/Example207_StokesTransient2D/">207 : Stokes Transient 2D</a></li><li><a class="tocitem" href="../examples/Example208_FlowTransport2D/">208 : Flow + Transport 2D</a></li><li><a class="tocitem" href="../examples/Example209_FaceLagrangeMultiplier2D/">209 : Lagrange Multiplier on Faces</a></li><li><a class="tocitem" href="../examples/Example210_NonlinearPoisson2D/">210 : Nonlinear Poisson Problem 2D</a></li><li><a class="tocitem" href="../examples/Example211_NonlinearElasticityBimetal2D/">211 : Nonlinear Elasticity Bimetal 2D</a></li><li><a class="tocitem" href="../examples/Example212_NonlinearPoissonTransient2D/">212 : Nonlinear Poisson Transient 2D</a></li><li><a class="tocitem" href="../examples/Example214_TwoNonlinearCoupled2D/">214 : Two nonlinearly coupled PDEs (2D)</a></li><li><a class="tocitem" href="../examples/Example215_ObstacleProblem2D/">215 : Obstacle Problem 2D</a></li><li><a class="tocitem" href="../examples/Example221_StokesIterated2D/">221 : Stokes iterated penalty method 2D</a></li><li><a class="tocitem" href="../examples/Example222_NavierStokesAnderson2D/">222 : Navier-Stokes Lid-driven cavity + Anderson Acceleration</a></li><li><a class="tocitem" href="../examples/Example223_NaturalConvection2D/">223 : Natural Convection 2D</a></li><li><a class="tocitem" href="../examples/Example224_FlowAroundCylinder2D/">224 : Flow around a cylinder 2D</a></li><li><a class="tocitem" href="../examples/Example225_CompressibleStokes2D/">225 : Compressible Stokes 2D</a></li><li><a class="tocitem" href="../examples/Example230_StokesHdivDG2D/">230 : Stokes Hdiv-DG 2D</a></li><li><a class="tocitem" href="../examples/Example231_StokesHdivP1RT/">231 : Stokes <span>$(P1 \oplus RT0) \times P0$</span></a></li><li><a class="tocitem" href="../examples/Example240_TransientFlowAroundCylinder2D/">240 : Transient Flow around a cylinder 2D</a></li><li><a class="tocitem" href="../examples/Example301_Poisson3D/">301 : Poisson-Problem 3D</a></li><li><a class="tocitem" href="../examples/Example302_BestapproximationHdiv3D/">302 : Bestapproximation Hdiv 3D</a></li><li><a class="tocitem" href="../examples/ExampleA01_RationalMassMatrix/">A01 : Rational Mass Matrix</a></li><li><a class="tocitem" href="../examples/ExampleA02_CommutingInterpolators2D/">A02 : Commuting Interpolators 2D</a></li><li><a class="tocitem" href="../examples/ExampleA03_CommutingInterpolators3D/">A03 : Commuting Interpolators 3D</a></li><li><a class="tocitem" href="../examples/ExampleA04_CustomLinearSolver/">A04 : Custom Linear Solvers</a></li><li><a class="tocitem" href="../examples/ExampleA05_DiffEQ/">A05 : Comparison with DifferentialEquations.jl</a></li><li><a class="tocitem" href="../examples/ExampleA06_LocalEquilibratedFluxes2D/">A06 : Local Equilibrated Fluxes 2D</a></li><li><a class="tocitem" href="../examples/ExampleA07_InterpolationBetweenMeshes/">A07 : Interpolation Between Meshes</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solving</a></li><li class="is-active"><a href>Time-Dependent Solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time-Dependent Solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/master/docs/src/timecontrolsolver.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-Dependent-Solvers"><a class="docs-heading-anchor" href="#Time-Dependent-Solvers">Time-Dependent Solvers</a><a id="Time-Dependent-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Dependent-Solvers" title="Permalink"></a></h1><h2 id="TimeControlSolver"><a class="docs-heading-anchor" href="#TimeControlSolver">TimeControlSolver</a><a id="TimeControlSolver-1"></a><a class="docs-heading-anchor-permalink" href="#TimeControlSolver" title="Permalink"></a></h2><p>The structure TimeControlSolver can be used to setup a time-dependent solver that can be configured in a similar manner as the time-independent ones (subiterations, nonlinear iterations, linear solvers). The following table lists the available TimeIntegrationRules:</p><table><tr><th style="text-align: center">Time integration rule</th><th style="text-align: center">order</th><th style="text-align: center">Formula</th></tr><tr><td style="text-align: center">BackwardEuler</td><td style="text-align: center">1</td><td style="text-align: center"><span>$(M^{n+1} + A^{n+1}) u^{n+1} = F^{n+1} + M^{n+1} u^n$</span></td></tr><tr><td style="text-align: center">CrankNicolson</td><td style="text-align: center">2</td><td style="text-align: center"><span>$(M^{n+1} + A^{n+1}) u^{n+1} = F^{n+1} + F^n - A^n u^n + M^{n+1} u^n$</span></td></tr></table><p>Note that currently the time-derivative (M terms) is added by the TimeControlSolver in each integration step and is in general not part of the PDEDescription (this might change in future). The default time derivative is a scaled (depends on the integration rule) mass matrix of the used finite element space, but the user can overwrite it via optional constructor arguments (experimental).</p><p>In case of the Crank-Nicolson scheme the user can mask unknowns of the PDE as an algebraic constraint (see add_unknown! in ProblemDescription). For these variables old iterates are not used on the right-hand side of the iteration formula. The pressure in the Navier-Stokes system is an example for such a constraint.</p><article class="docstring"><header><a class="docstring-binding" id="GradientRobustMultiPhysics.TimeControlSolver" href="#GradientRobustMultiPhysics.TimeControlSolver"><code>GradientRobustMultiPhysics.TimeControlSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">function TimeControlSolver(
    PDE::PDEDescription,                                        # PDE system description
    InitialValues::FEVector{T,Tv,Ti},                           # contains initial values and stores solution of advance! methods
    TIR::Type{&lt;:AbstractTimeIntegrationRule} = BackwardEuler;   # Time integration rule
    dt_operator = [],                                           # Operator in time derivative (default: Identity) for each subiteration (applied to test and ansatz function)
    dt_action = [],                                             # Action in time derivative (deulta: NoAction) for each subiteration
    dt_is_nonlinear = [],                                          # is the time derivative nonlinear?
    T_time = Float64,                                           # Type for timestep and total time
    kwargs...) where {T,Tv,Ti}                                  # additional solver arguments</code></pre><p>Creates a time-dependent solver that can be advanced in time with advance!. The FEVector Solution stores the initial state but also the solution at the current time. The argument TIR carries the time integration rule to be use (e.g. BackwardEuler or CrankNicolson). T_time determines the NumberType of the timesteps and total time.</p><p>Keyword arguments:</p><ul><li><p>subiterations: an array of equation subsets (each an array) that should be solved together in each fixpoint iteration. Default: &#39;&#39;auto&#39;&#39;</p></li><li><p>show<em>iteration</em>details: show details (residuals etc.) of each iteration. Default: true</p></li><li><p>timedependent_equations: array of the equations that should get a time derivative (only for TimeControlSolver). Default: Any[]</p></li><li><p>show_statistics: show some statistics like assembly times. Default: false</p></li><li><p>skip<em>update: matrix update (for the j-th sub-iteration) will be performed each skip</em>update[j] iteration; -1 means only in the first iteration. Default: [1]</p></li><li><p>linsolver: String that encodes the linear solver, or type name of self-defined solver (see corressponding example), or type name of ExtendableSparse.AbstractFactorization. Default: &#39;&#39;UMFPACK&#39;&#39;</p></li><li><p>time: time at which time-dependent data functions are evaluated or initial time for TimeControlSolver. Default: 0</p></li><li><p>show<em>solver</em>config: show the complete solver configuration before starting to solve. Default: false</p></li><li><p>check<em>nonlinear</em>residual: check the nonlinear residual in last nonlinear iteration (causes one more reassembly of nonlinear terms). Default: &#39;&#39;auto&#39;&#39;</p></li><li><p>fixed_penalty: penalty that is used for the values of fixed degrees of freedom (e.g. by Dirichlet boundary data or global constraints). Default: 1.0e60</p></li><li><p>target_residual: stop fixpoint iterations if the (nonlinear) residual is smaller than this number. Default: 1.0e-10</p></li><li><p>maxiterations: maximal number of nonlinear iterations (TimeControlSolver runs that many in each time step). Default: &#39;&#39;auto&#39;&#39;</p></li></ul><p>Further (very experimental) optional arguments for TimeControlSolver are:</p><ul><li>dt_operator : (array of) operators applied to testfunctions in time derivative (default: Identity)</li><li>dt_action : (array of) actions that are applied to the ansatz function in the time derivative (to include parameters etc.)</li><li>dt<em>is</em>nonlinear : (array of) booleans to decide which time derivatives should be recomputed in each timestep</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/8c0dc3d49368392d123013d903cba14f90939d62/src/solvers.jl#L1259-L1285">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GradientRobustMultiPhysics.advance!" href="#GradientRobustMultiPhysics.advance!"><code>GradientRobustMultiPhysics.advance!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function TimeControlSolver(
    advance!(TCS::TimeControlSolver, timestep::Real = 1e-1)</code></pre><p>Advances a TimeControlSolver one step in time with the given timestep.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/8c0dc3d49368392d123013d903cba14f90939d62/src/solvers.jl#L1440-L1448">source</a></section></article><h2 id="Advancing-a-TimeControlSolver"><a class="docs-heading-anchor" href="#Advancing-a-TimeControlSolver">Advancing a TimeControlSolver</a><a id="Advancing-a-TimeControlSolver-1"></a><a class="docs-heading-anchor-permalink" href="#Advancing-a-TimeControlSolver" title="Permalink"></a></h2><p>There are two functions that advance the TimeControlSolver automatically until a given final time (advance_until_time!) is reached or until stationarity is reached (advance_until_stationarity!). As an experimental feature, one can add the module DifferentialEquations.jl as the first argument to these methods to let this module run the time integration (the native TimeIntegrationRule argument in the TimeControlSolver constuctor is ignored in this case).</p><article class="docstring"><header><a class="docstring-binding" id="GradientRobustMultiPhysics.advance_until_time!" href="#GradientRobustMultiPhysics.advance_until_time!"><code>GradientRobustMultiPhysics.advance_until_time!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">advance_until_time!(TCS::TimeControlSolver, timestep, finaltime; finaltime_tolerance = 1e-15, do_after_each_timestep = nothing)</code></pre><p>Advances a TimeControlSolver in time with the given (initial) timestep until the specified finaltime is reached (up to the specified tolerance). The function do<em>after</em>timestep is called after each timestep and can be used to print/save data (and maybe timestep control in future).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/8c0dc3d49368392d123013d903cba14f90939d62/src/solvers.jl#L1816-L1823">source</a></section><section><div><pre><code class="nohighlight hljs">advance_until_time!(DiffEQ::Module, TCS::TimeControlSolver, timestep, finaltime; solver = nothing, abstol = 1e-1, reltol = 1e-1, dtmin = 0, adaptive::Bool = true)</code></pre><p>Advances a TimeControlSolver in time with the given (initial) timestep until the specified finaltime is reached (up to the specified tolerance) with the given exterior time integration module. The only valid Module here is DifferentialEquations.jl and the optional arguments are passed to it. If solver == nothing the solver Rosenbrock23(autodiff = false) will be chosen. For more choices please consult the documentation of DifferentialEquations.jl.</p><p>Also note that this is a highly experimental feature and will not work for general TimeControlSolvers configuration (e.g. in the case of several subiterations or, it seems, saddle point problems). Also have a look at corressponding the example in the advanced examples section.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/8c0dc3d49368392d123013d903cba14f90939d62/src/solvers.jl#L1891-L1902">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GradientRobustMultiPhysics.advance_until_stationarity!" href="#GradientRobustMultiPhysics.advance_until_stationarity!"><code>GradientRobustMultiPhysics.advance_until_stationarity!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">advance_until_stationarity!(TCS::TimeControlSolver, timestep; stationarity_threshold = 1e-11, maxTimeSteps = 100, do_after_each_timestep = nothing)</code></pre><p>Advances a TimeControlSolver in time with the given (initial) timestep until stationarity is detected (change of variables below threshold) or a maximal number of time steps is exceeded. The function do<em>after</em>timestep is called after each timestep and can be used to print/save data (and maybe timestep control in future).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/8c0dc3d49368392d123013d903cba14f90939d62/src/solvers.jl#L1738-L1745">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesolvers/">« Fixed-Time Solvers</a><a class="docs-footer-nextpage" href="../itemintegrators/">Item Integrators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 21 October 2021 19:54">Thursday 21 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
