<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function Operators · GradientRobustMultiPhysics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../home/">GradientRobustMultiPhysics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../home/">Home</a></li><li><a class="tocitem" href="../">Index</a></li><li><span class="tocitem">Problem Description</span><ul><li><a class="tocitem" href="../pdedescription/">PDE Description</a></li><li><a class="tocitem" href="../pdeoperators/">PDE Operators</a></li><li class="is-active"><a class="tocitem" href>Function Operators</a><ul class="internal"><li><a class="tocitem" href="#Available-Operators"><span>Available Operators</span></a></li><li><a class="tocitem" href="#Jumps-and-Averages"><span>Jumps and Averages</span></a></li><li><a class="tocitem" href="#Reconstruction-Operators"><span>Reconstruction Operators</span></a></li><li><a class="tocitem" href="#Operator-Pairs-(experimental)"><span>Operator Pairs (experimental)</span></a></li></ul></li><li><a class="tocitem" href="../userdata/">User Data and Actions</a></li><li><a class="tocitem" href="../boundarydata/">Boundary Data</a></li><li><a class="tocitem" href="../globalconstraints/">Global Constraints</a></li><li><a class="tocitem" href="../pdeprototypes/">PDE Prototypes</a></li></ul></li><li><span class="tocitem">Discretisation</span><ul><li><a class="tocitem" href="../meshing/">Meshing</a></li><li><a class="tocitem" href="../fems/">Implemented Finite Elements</a></li><li><a class="tocitem" href="../fespace/">Finite Element Spaces and Arrays</a></li><li><a class="tocitem" href="../interpolations/">Finite Element Interpolations</a></li></ul></li><li><span class="tocitem">Solving</span><ul><li><a class="tocitem" href="../pdesolvers/">Fixed-Time Solvers</a></li><li><a class="tocitem" href="../timecontrolsolver/">Time-Dependent Solvers</a></li></ul></li><li><span class="tocitem">Postprocessing</span><ul><li><a class="tocitem" href="../itemintegrators/">Item Integrators</a></li><li><a class="tocitem" href="../pointevaluators/">Point Evaluators</a></li><li><a class="tocitem" href="../viewers/">Viewers</a></li><li><a class="tocitem" href="../export/">Data Export</a></li></ul></li><li><span class="tocitem">Low-Level Structures</span><ul><li><a class="tocitem" href="../quadrature/">Quadrature</a></li><li><a class="tocitem" href="../assemblypatterns/">Assembly Patterns</a></li><li><a class="tocitem" href="../febasisevaluators/">FE Basis Evaluators</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples_intro/">About the examples</a></li><li><a class="tocitem" href="../examples/Example101_Bestapproximation1D/">101 : L2-Bestapproximation 1D</a></li><li><a class="tocitem" href="../examples/Example102_RobinBoundaryCondition1D/">102 : Robin-Boundary Conditions 1D</a></li><li><a class="tocitem" href="../examples/Example201_PoissonProblem2D/">201 : Poisson-Problem 2D</a></li><li><a class="tocitem" href="../examples/Example202_LinearElasticity2D/">202 : Linear Elasticity</a></li><li><a class="tocitem" href="../examples/Example203_ReactionConvectionDiffusion2D/">203 : Reaction-Convection-Diffusion-Problem 2D</a></li><li><a class="tocitem" href="../examples/Example203_ReactionConvectionDiffusionSUPG2D/">203 : Reaction-Convection-Diffusion-Problem SUPG 2D</a></li><li><a class="tocitem" href="../examples/Example204_PoissonLshapeAdaptive2D/">204 : Poisson L-shape Adaptive Mesh Refinement</a></li><li><a class="tocitem" href="../examples/Example205_PlanarLatticeFlow2D/">205 : Planar Lattice Flow 2D</a></li><li><a class="tocitem" href="../examples/Example206_PressureRobustness2D/">206 : Pressure-robustness 2D</a></li><li><a class="tocitem" href="../examples/Example207_StokesTransient2D/">207 : Stokes Transient 2D</a></li><li><a class="tocitem" href="../examples/Example208_FlowTransport2D/">208 : Flow + Transport 2D</a></li><li><a class="tocitem" href="../examples/Example209_FaceLagrangeMultiplier2D/">209 : Lagrange Multiplier on Faces</a></li><li><a class="tocitem" href="../examples/Example210_NonlinearPoisson2D/">210 : Nonlinear Poisson Problem 2D</a></li><li><a class="tocitem" href="../examples/Example211_NonlinearElasticityBimetal2D/">211 : Nonlinear Elasticity Bimetal 2D</a></li><li><a class="tocitem" href="../examples/Example212_NonlinearPoissonTransient2D/">212 : Nonlinear Poisson Transient 2D</a></li><li><a class="tocitem" href="../examples/Example214_TwoNonlinearCoupled2D/">214 : Two nonlinearly coupled PDEs (2D)</a></li><li><a class="tocitem" href="../examples/Example215_ObstacleProblem2D/">215 : Obstacle Problem 2D</a></li><li><a class="tocitem" href="../examples/Example221_StokesIterated2D/">221 : Stokes iterated penalty method 2D</a></li><li><a class="tocitem" href="../examples/Example222_NavierStokesAnderson2D/">222 : Navier-Stokes Lid-driven cavity + Anderson Acceleration</a></li><li><a class="tocitem" href="../examples/Example223_NaturalConvection2D/">223 : Natural Convection 2D</a></li><li><a class="tocitem" href="../examples/Example224_FlowAroundCylinder2D/">224 : Flow around a cylinder 2D</a></li><li><a class="tocitem" href="../examples/Example225_CompressibleStokes2D/">225 : Compressible Stokes 2D</a></li><li><a class="tocitem" href="../examples/Example230_StokesHdivDG2D/">230 : Stokes Hdiv-DG 2D</a></li><li><a class="tocitem" href="../examples/Example231_StokesHdivP1RT/">231 : Stokes <span>$(P1 \oplus RT0) \times P0$</span></a></li><li><a class="tocitem" href="../examples/Example240_TransientFlowAroundCylinder2D/">240 : Transient Flow around a cylinder 2D</a></li><li><a class="tocitem" href="../examples/Example250_LevelSetMethod2D/">250 : Level Set Method 2D</a></li><li><a class="tocitem" href="../examples/Example301_Poisson3D/">301 : Poisson-Problem 3D</a></li><li><a class="tocitem" href="../examples/Example302_BestapproximationHdiv3D/">302 : Bestapproximation Hdiv 3D</a></li><li><a class="tocitem" href="../examples/ExampleA01_RationalMassMatrix/">A01 : Rational Mass Matrix</a></li><li><a class="tocitem" href="../examples/ExampleA02_CommutingInterpolators2D/">A02 : Commuting Interpolators 2D</a></li><li><a class="tocitem" href="../examples/ExampleA03_CommutingInterpolators3D/">A03 : Commuting Interpolators 3D</a></li><li><a class="tocitem" href="../examples/ExampleA04_CustomLinearSolver/">A04 : Custom Linear Solvers</a></li><li><a class="tocitem" href="../examples/ExampleA05_DiffEQ/">A05 : Comparison with DifferentialEquations.jl</a></li><li><a class="tocitem" href="../examples/ExampleA06_LocalEquilibratedFluxes2D/">A06 : Local Equilibrated Fluxes 2D</a></li><li><a class="tocitem" href="../examples/ExampleA07_InterpolationBetweenMeshes/">A07 : Interpolation Between Meshes</a></li><li><a class="tocitem" href="../examples/ExampleA08_BasisPlotter/">A08 : Basis-Plotter</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Problem Description</a></li><li class="is-active"><a href>Function Operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Function Operators</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/master/docs/src/functionoperators.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Function-Operators"><a class="docs-heading-anchor" href="#Function-Operators">Function Operators</a><a id="Function-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Operators" title="Permalink"></a></h1><h2 id="Available-Operators"><a class="docs-heading-anchor" href="#Available-Operators">Available Operators</a><a id="Available-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Operators" title="Permalink"></a></h2><p>FunctionOperators are building blocks for the weak form and define the operations that should be applied to the trial and test functions (and their discrete representatives) inside some PDEOperator. Below is a list of currently available FunctionOperators. Note, that not all operators can be applied to all finite element types in principle, but potentially have to be understood in a broken sense and only make sense on certain parts of the mesh (e.g. NormalFlux only on a face). Also note that all evaluations are returned as a vector,  so e.g.\ a gradient of a 2d vector-field will be a vector of length 4 (ordered component-wise).</p><table><tr><th style="text-align: left">Function operator</th><th style="text-align: left">Description</th><th style="text-align: left">Mathematically</th></tr><tr><td style="text-align: left">Identity</td><td style="text-align: left">identity</td><td style="text-align: left"><span>$v \rightarrow v$</span></td></tr><tr><td style="text-align: left">IdentityComponent{c}</td><td style="text-align: left">identity of c-th component</td><td style="text-align: left"><span>$v \rightarrow v_c$</span></td></tr><tr><td style="text-align: left">NormalFlux</td><td style="text-align: left">normal flux (function times normal)</td><td style="text-align: left"><span>$v \rightarrow v \cdot \vec{n}$</span> (only ON_FACES)</td></tr><tr><td style="text-align: left">TangentFlux</td><td style="text-align: left">tangent flux (function times tangent)</td><td style="text-align: left"><span>$v \rightarrow v \cdot \vec{t}$</span> (only ON_EDGES)</td></tr><tr><td style="text-align: left">Gradient</td><td style="text-align: left">gradient/Jacobian (as a vector)</td><td style="text-align: left"><span>$v \rightarrow \nabla v$</span></td></tr><tr><td style="text-align: left">SymmetricGradient</td><td style="text-align: left">symmetric part of the gradient</td><td style="text-align: left"><span>$v \rightarrow Voigt(\mathrm{sym}(\nabla v))$</span></td></tr><tr><td style="text-align: left">Divergence</td><td style="text-align: left">divergence</td><td style="text-align: left"><span>$v \rightarrow \mathrm{div}(v) = \nabla \cdot v$</span></td></tr><tr><td style="text-align: left">CurlScalar</td><td style="text-align: left">curl operator 1D to 2D (rotated gradient)</td><td style="text-align: left"><span>$v \rightarrow [-dv/dx_2,dv/dx_1]$</span></td></tr><tr><td style="text-align: left">Curl2D</td><td style="text-align: left">curl operator 2D to 1D</td><td style="text-align: left"><span>$v \rightarrow dv_1/dx_2 - dv_2/dx_1$</span></td></tr><tr><td style="text-align: left">Curl3D</td><td style="text-align: left">curl operator 3D to 3D</td><td style="text-align: left"><span>$v \rightarrow \nabla \times v$</span></td></tr><tr><td style="text-align: left">Hessian</td><td style="text-align: left">Hesse matrix = all 2nd order derivatives (as a vector)</td><td style="text-align: left"><span>$v \rightarrow D^2 v$</span>      (e.g. in 2D: xx,xy,yx,yy for each component)</td></tr><tr><td style="text-align: left">SymmetricHessian{a}</td><td style="text-align: left">symmetric part of Hesse matrix, offdiagonals scaled by a</td><td style="text-align: left"><span>$v \rightarrow sym(D^2 v)$</span> (e.g. in 2D: xx,yy,a*xy for each component)</td></tr><tr><td style="text-align: left">Laplacian</td><td style="text-align: left">Laplace Operator (diagonal of Hessian)</td><td style="text-align: left"><span>$v \rightarrow \Delta v$</span>   (e.g. in 2D: xx,yy for each component)</td></tr></table><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>As each finite element type is transformed differently from the reference domain to the general domain, the evaluation of each function operator has to be implemented for each finite element class. Currently, not every function operator works in any dimension and for any finite element. More evaluations are added as soon as they are needed (and possibly upon request). Also, the function operators can be combined with user-defined actions to evaluate other operators that can be build from the ones available (e.g. the deviator).</p></div></div><h2 id="Jumps-and-Averages"><a class="docs-heading-anchor" href="#Jumps-and-Averages">Jumps and Averages</a><a id="Jumps-and-Averages-1"></a><a class="docs-heading-anchor-permalink" href="#Jumps-and-Averages" title="Permalink"></a></h2><p>If one of the operators above is evaluted ON_FACES for a finite element that is not continuous there, the code usually will crash or produce weird results. However, some operators can be transformed into a Jump- or Average operator and then either the jumps or the average of this operator along the face is assembled. The operator Jump(Identity) for example gives the jump of the identity evaluation on both sides of the face.</p><article class="docstring"><header><a class="docstring-binding" id="GradientRobustMultiPhysics.Jump" href="#GradientRobustMultiPhysics.Jump"><code>GradientRobustMultiPhysics.Jump</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">function Jump(::Type{&lt;:AbstractFunctionOperator})</code></pre><p>Transforms operator inito its jump evaluation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/d8f66bed547b2d2c7540bfc201811f4a55319c5b/src/functionoperators.jl#L155-L161">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GradientRobustMultiPhysics.Average" href="#GradientRobustMultiPhysics.Average"><code>GradientRobustMultiPhysics.Average</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">function Average::Type{&lt;:AbstractFunctionOperator})</code></pre><p>Transforms operator inito its average evaluation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/d8f66bed547b2d2c7540bfc201811f4a55319c5b/src/functionoperators.jl#L164-L170">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Currently this feature is only available for assembly on faces (2D and 3D) and certain function operators like Identity, Gradient, ReconstructionIdentity, ReconstructionGradient, NormalFlux, TangentFlux, but more are added as soon as they are needed (and possibly upon request).</p><p>Also note that if a Jump or Average operator has different behaviour depending on the Assembly Pattern it is used in. Usually, the input of the action used in the assembly pattern has the evaluation on one of the two neighbours at a time, but this should be okay in a linear context. Only in ItemIntegrators the whole jump comes in. In NonlinearForms jumps and averages should better not be used currently.</p></div></div><h2 id="Reconstruction-Operators"><a class="docs-heading-anchor" href="#Reconstruction-Operators">Reconstruction Operators</a><a id="Reconstruction-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Reconstruction-Operators" title="Permalink"></a></h2><p>There are special operators (see Table below) that allow to evaluate a usual operator of some discrete reconstructed version of a vector-valued testfunction. These operators keep the discrete divergence exactly and so allow for gradient-robust discretisations with classical non divergence-conforming ansatz spaces. So far such operators are available for the vector-valued Crouzeix-Raviart and Bernardi–Raugel finite element types.</p><table><tr><th style="text-align: left">Function operator</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">ReconstructionIdentity{FEType}</td><td style="text-align: left">reconstruction operator into specified FEType</td></tr><tr><td style="text-align: left">ReconstructionDivergence{FEType}</td><td style="text-align: left">divergence of FEType reconstruction operator</td></tr><tr><td style="text-align: left">ReconstructionGradient{FEType}</td><td style="text-align: left">gradient of FEType reconstruction operator</td></tr></table><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Currently this feature works with FEType = HdivRT0{d} and FEType = HdivBDM1{d} where d is the space dimension. However, solve! on a PDEDescription that includes these operators will only work if the function operators are at spots were it is applied to functions of type H1BR, H1CR or H1P2B. More reconstruction operators will be implemented at some later point.</p></div></div><h2 id="Operator-Pairs-(experimental)"><a class="docs-heading-anchor" href="#Operator-Pairs-(experimental)">Operator Pairs (experimental)</a><a id="Operator-Pairs-(experimental)-1"></a><a class="docs-heading-anchor-permalink" href="#Operator-Pairs-(experimental)" title="Permalink"></a></h2><p>Two function operators can be put into an OperatorPair so that one can provide effectively two operators in each argument of an assembly pattern. However, the user should make sure that both operators can be evaluated together reasonably (meaning both should be well-defined on the element geometries and the finite element space where the argument will be evaluated, and the action of the operator has to operate with coressponding input and result fields). This feature is still experimental and might have issues in some cases. OperatorTriple for a combination of three operators is also available.</p><article class="docstring"><header><a class="docstring-binding" id="GradientRobustMultiPhysics.OperatorPair" href="#GradientRobustMultiPhysics.OperatorPair"><code>GradientRobustMultiPhysics.OperatorPair</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type OperatorPair{&lt;:AbstractFunctionOperator,&lt;:AbstractFunctionOperator} &lt;: AbstractFunctionOperator</code></pre><p>allows to evaluate two operators in place of one, e.g. OperatorPair{Identity,Gradient}.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/d8f66bed547b2d2c7540bfc201811f4a55319c5b/src/functionoperators.jl#L270-L276">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GradientRobustMultiPhysics.OperatorTriple" href="#GradientRobustMultiPhysics.OperatorTriple"><code>GradientRobustMultiPhysics.OperatorTriple</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type OperatorTriple{&lt;:AbstractFunctionOperator,&lt;:AbstractFunctionOperator} &lt;: AbstractFunctionOperator</code></pre><p>allows to evaluate three operators in place of one, e.g. OperatorTriple{Identity,Gradient,Hessian}.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/blob/d8f66bed547b2d2c7540bfc201811f4a55319c5b/src/functionoperators.jl#L283-L289">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdeoperators/">« PDE Operators</a><a class="docs-footer-nextpage" href="../userdata/">User Data and Actions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 2 December 2021 14:46">Thursday 2 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
